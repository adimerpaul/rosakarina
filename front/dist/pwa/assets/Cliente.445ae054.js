import{_ as v,O as p,P as f,Q as n,R as l,T as c,aG as d,$ as g,S as u,J as h,V as b,aH as w,aI as _,U as D,bb as y,aJ as k}from"./index.441a13ee.js";import{Q as I}from"./QPagination.aaa15187.js";import{a as V,b as m}from"./QMenu.f5becda0.js";import{Q}from"./QItemLabel.f6751363.js";import{Q as N}from"./QList.13b281b7.js";import{Q as U}from"./QBtnDropdown.3aa191bd.js";import{Q as E,a as G}from"./QTable.5e2b9625.js";import{Q as P}from"./QSpace.1f3c5873.js";import{Q as q}from"./QForm.eddcae5f.js";import{Q as T}from"./QPage.96bccc7f.js";import{C}from"./ClosePopup.74b16447.js";import"./format.2cae61da.js";import"./QBtnGroup.1190c0d9.js";import"./QMarkupTable.db478646.js";import"./QSelect.df2c9c69.js";import"./QChip.269e3a83.js";const A={name:"ClientePage",data(){return{clientes:[],cliente:{},clienteDialog:!1,loading:!1,filter:"",current_page:1,total:0,per_page:10,columns:[{name:"actions",label:"Acciones",align:"center"},{name:"nombre",label:"Nombre",align:"left",field:"nombre",sortable:!0},{name:"ci",label:"CI / NIT",align:"left",field:"ci",sortable:!0},{name:"telefono",label:"Tel\xE9fono",align:"left",field:"telefono"},{name:"direccion",label:"Direcci\xF3n",align:"left",field:"direccion"}]}},mounted(){this.clientesGet()},methods:{resetAndFetch(){this.current_page=1,this.clientesGet()},clienteNew(){this.cliente={nombre:"",ci:"",telefono:"",direccion:""},this.clienteDialog=!0},clientesGet(){this.loading=!0,this.$axios.get("clientes",{params:{search:this.filter,page:this.current_page}}).then(i=>{i.data&&Array.isArray(i.data.data)?(this.clientes=i.data.data,this.total=i.data.total||0,this.per_page=i.data.per_page||10,this.current_page=i.data.current_page||this.current_page):Array.isArray(i.data)?(this.clientes=i.data,this.total=i.data.length,this.per_page=10,this.current_page=1):this.clientes=[]}).catch(i=>{var o,s;const e=((s=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:s.message)||"Error al cargar clientes";this.$alert.error(e)}).finally(()=>{this.loading=!1})},clienteEdit(i,e){const o=e||i;!o||!o.id||(this.cliente={...o},this.clienteDialog=!0)},clientePost(){this.loading=!0,this.$axios.post("clientes",this.cliente).then(()=>{this.clientesGet(),this.clienteDialog=!1,this.$alert.success("Cliente creado")}).catch(i=>{var o,s;const e=((s=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:s.message)||"Error al crear cliente";this.$alert.error(e)}).finally(()=>{this.loading=!1})},clientePut(){this.loading=!0,this.$axios.put("clientes/"+this.cliente.id,this.cliente).then(()=>{this.clientesGet(),this.clienteDialog=!1,this.$alert.success("Cliente actualizado")}).catch(i=>{var o,s;const e=((s=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:s.message)||"Error al actualizar cliente";this.$alert.error(e)}).finally(()=>{this.loading=!1})},clienteDelete(i){this.$alert.dialog("\xBFDesea eliminar el cliente?").onOk(()=>{this.loading=!0,this.$axios.delete("clientes/"+i).then(()=>{this.clientesGet(),this.$alert.success("Cliente eliminado")}).catch(e=>{var s,t;const o=((t=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:t.message)||"Error al eliminar cliente";this.$alert.error(o)}).finally(()=>{this.loading=!1})})}}},B={style:{width:"100%"}},S={class:"flex flex-center q-mt-sm"},z={class:"text-subtitle2"},F={class:"text-right q-mt-sm"};function O(i,e,o,s,t,r){return p(),f(T,{class:"q-pa-md"},{default:n(()=>[l(G,{rows:t.clientes,columns:t.columns,"row-key":"id",dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"Clientes","hide-bottom":""},{top:n(()=>[c("div",B,[c("div",null,[l(d,{modelValue:t.filter,"onUpdate:modelValue":[e[0]||(e[0]=a=>t.filter=a),r.resetAndFetch],label:"Buscar (nombre, CI, tel\xE9fono)",dense:"",outlined:"",clearable:"",debounce:500},{append:n(()=>[l(g,{name:"search"})]),before:n(()=>[l(u,{color:"positive",label:"Nuevo",icon:"add_circle_outline","no-caps":"",loading:t.loading,onClick:r.clienteNew},null,8,["loading","onClick"])]),_:1},8,["modelValue","onUpdate:modelValue"])]),c("div",S,[l(I,{modelValue:t.current_page,"onUpdate:modelValue":[e[1]||(e[1]=a=>t.current_page=a),r.clientesGet],max:Math.ceil(t.total/t.per_page)||1,"max-pages":5},null,8,["modelValue","max","onUpdate:modelValue"])])])]),"body-cell-actions":n(a=>[l(E,{props:a,class:"text-center"},{default:n(()=>[l(U,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:n(()=>[l(N,null,{default:n(()=>[h((p(),f(V,{clickable:"",onClick:x=>r.clienteEdit(null,a.row)},{default:n(()=>[l(m,{avatar:""},{default:n(()=>[l(g,{name:"edit"})]),_:1}),l(m,null,{default:n(()=>[l(Q,null,{default:n(()=>e[10]||(e[10]=[b("Editar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[C]]),h((p(),f(V,{clickable:"",onClick:x=>r.clienteDelete(a.row.id)},{default:n(()=>[l(m,{avatar:""},{default:n(()=>[l(g,{name:"delete"})]),_:1}),l(m,null,{default:n(()=>[l(Q,null,{default:n(()=>e[11]||(e[11]=[b("Eliminar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[C]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),l(k,{modelValue:t.clienteDialog,"onUpdate:modelValue":e[9]||(e[9]=a=>t.clienteDialog=a),persistent:""},{default:n(()=>[l(w,{style:{"min-width":"360px","max-width":"520px",width:"95vw"}},{default:n(()=>[l(_,{class:"q-pb-none row items-center"},{default:n(()=>[c("div",z,D(t.cliente.id?"Editar":"Nuevo")+" cliente ",1),l(P),l(u,{icon:"close",flat:"",round:"",dense:"",onClick:e[2]||(e[2]=a=>t.clienteDialog=!1)})]),_:1}),l(_,{class:"q-pt-none"},{default:n(()=>[l(q,{onSubmit:e[8]||(e[8]=y(a=>t.cliente.id?r.clientePut():r.clientePost(),["prevent"]))},{default:n(()=>[l(d,{modelValue:t.cliente.nombre,"onUpdate:modelValue":e[3]||(e[3]=a=>t.cliente.nombre=a),label:"Nombre",dense:"",outlined:"",rules:[a=>!!a||"Campo requerido"]},null,8,["modelValue","rules"]),l(d,{modelValue:t.cliente.ci,"onUpdate:modelValue":e[4]||(e[4]=a=>t.cliente.ci=a),label:"CI / NIT",dense:"",outlined:"",rules:[a=>!!a||"Campo requerido"]},null,8,["modelValue","rules"]),l(d,{modelValue:t.cliente.telefono,"onUpdate:modelValue":e[5]||(e[5]=a=>t.cliente.telefono=a),label:"Tel\xE9fono",dense:"",outlined:""},null,8,["modelValue"]),l(d,{modelValue:t.cliente.direccion,"onUpdate:modelValue":e[6]||(e[6]=a=>t.cliente.direccion=a),label:"Direcci\xF3n",dense:"",outlined:"",type:"textarea",autogrow:""},null,8,["modelValue"]),c("div",F,[l(u,{color:"negative",label:"Cancelar","no-caps":"",loading:t.loading,onClick:e[7]||(e[7]=a=>t.clienteDialog=!1)},null,8,["loading"]),l(u,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:t.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var ae=v(A,[["render",O]]);export{ae as default};
