import{_ as b,O as c,P as V,Q as d,R as r,aI as Q,T as e,U as a,aG as x,aK as P,S as C,X as p,Y as k,Z as y,aH as q,V as h}from"./index.441a13ee.js";import{Q as B}from"./QSelect.df2c9c69.js";import{Q as v}from"./QBadge.70a588ac.js";import{Q as D}from"./QMarkupTable.db478646.js";import{Q as R}from"./QPage.96bccc7f.js";import{h as f}from"./moment.40bc58bf.js";import"./QChip.269e3a83.js";import"./QMenu.f5becda0.js";import"./QItemLabel.f6751363.js";import"./format.2cae61da.js";const S={name:"ProductosPorVencer",data(){return{valor:1,unidad:"meses",dias:1,productos:[],proveedores:[],proveedor_id:null,loading:!1}},mounted(){this.cargarProveedores(),this.consultar()},methods:{cargarProveedores(){this.$axios.get("/proveedores").then(l=>{this.proveedores=l.data})},consultar(){this.dias=this.convertirADias(this.valor,this.unidad),this.loading=!0,this.$axios.get("/productosPorVencer",{params:{dias:this.dias,proveedor_id:this.proveedor_id}}).then(l=>{this.productos=l.data}).catch(()=>{this.$alert.error("Error al consultar productos por vencer")}).finally(()=>{this.loading=!1})},convertirADias(l,t){switch(t){case"semanas":return l*7;case"meses":return l*30;case"anios":return l*365;default:return l}},diasRestantesColor(l){const t=f(),n=f(l).diff(t,"days"),s=Math.ceil(this.dias/3);return n<=s?{color:"red",dias:n}:n<=s*2?{color:"orange",dias:n}:{color:"green",dias:n}}}},A={class:"text-h6"},M={class:"row items-end q-col-gutter-md"},U={class:"col-12 col-md-2"},w={class:"col-12 col-md-4"},E={class:"col-12 col-md-3"},F={class:"col-12 col-md-2"};function N(l,t,_,n,s,i){return c(),V(R,{class:"q-pa-xs"},{default:d(()=>[r(q,{flat:"",bordered:""},{default:d(()=>[r(Q,{class:"q-pa-xs"},{default:d(()=>[e("div",A,"Productos por vencer en "+a(s.dias)+" d\xEDas",1),e("div",M,[e("div",U,[r(x,{modelValue:s.valor,"onUpdate:modelValue":t[0]||(t[0]=o=>s.valor=o),modelModifiers:{number:!0},type:"number",min:"1",label:"Cantidad",dense:"",outlined:""},null,8,["modelValue"])]),e("div",w,[r(P,{modelValue:s.unidad,"onUpdate:modelValue":t[1]||(t[1]=o=>s.unidad=o),options:[{label:"D\xEDas",value:"dias"},{label:"Semanas",value:"semanas"},{label:"Meses",value:"meses"},{label:"A\xF1os",value:"anios"}],type:"radio",inline:"",dense:""},null,8,["modelValue"])]),e("div",E,[r(B,{modelValue:s.proveedor_id,"onUpdate:modelValue":t[2]||(t[2]=o=>s.proveedor_id=o),options:s.proveedores,"option-label":"nombre","option-value":"id","emit-value":"","map-options":"",dense:"",outlined:"",clearable:"",label:"Proveedor (opcional)"},null,8,["modelValue","options"])]),e("div",F,[r(C,{label:"Consultar",color:"green",icon:"search",class:"q-mt-sm",onClick:i.consultar,loading:s.loading,"no-caps":""},null,8,["onClick","loading"])])]),r(D,{dense:"",class:"q-mt-md",flat:"",bordered:""},{default:d(()=>[t[3]||(t[3]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Producto"),e("th",null,"Cantidad"),e("th",null,"Factura"),e("th",null,"Lote"),e("th",null,"Proveedor"),e("th",null,"Fecha de Vencimiento"),e("th",null,"Estado"),e("th",null,"D\xEDas restantes")])],-1)),e("tbody",null,[(c(!0),p(y,null,k(s.productos,(o,g)=>{var u,m;return c(),p("tr",{key:o.id},[e("td",null,a(g+1),1),e("td",null,a((u=o.producto)==null?void 0:u.nombre),1),e("td",null,a(o.cantidad_venta),1),e("td",null,a(o.compra.nro_factura),1),e("td",null,a(o.lote),1),e("td",null,a((m=o.proveedor)==null?void 0:m.nombre),1),e("td",null,a(o.fecha_vencimiento),1),e("td",null,[r(v,{color:o.estado==="Activo"?"green":"red",class:"q-pa-xs"},{default:d(()=>[h(a(o.estado),1)]),_:2},1032,["color"])]),e("td",null,[r(v,{color:i.diasRestantesColor(o.fecha_vencimiento).color,class:"q-pa-xs"},{default:d(()=>[h(a(i.diasRestantesColor(o.fecha_vencimiento).dias)+" d\xEDas ",1)]),_:2},1032,["color"])])])}),128))])]),_:1})]),_:1})]),_:1})]),_:1})}var j=b(S,[["render",N]]);export{j as default};
